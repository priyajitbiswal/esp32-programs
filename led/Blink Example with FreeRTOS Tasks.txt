/* Blink Example with FreeRTOS Tasks
   - LED1 blinks every 500ms
   - LED2 and LED3 blink alternatively every 500ms
   Public Domain / CC0
*/

#include <stdio.h>
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "driver/gpio.h"
#include "esp_log.h"
#include "esp_mac.h"

static const char *TAG = "example";

// Define GPIO pins for LEDs
#define LED1 2 // GPIO2
// #define LED2 4 // GPIO4
// #define LED3 5 // GPIO5

// Configure all LEDs
static void configure_leds(void)
{
    gpio_reset_pin(LED1);
    gpio_set_direction(LED1, GPIO_MODE_OUTPUT);

    // gpio_reset_pin(LED2);
    // gpio_set_direction(LED2, GPIO_MODE_OUTPUT);

    // gpio_reset_pin(LED3);
    // gpio_set_direction(LED3, GPIO_MODE_OUTPUT);
}

// Task 1: Blink LED1 at 500ms
void led1_task(void *pvParameter)
{
    while (1)
    {
        gpio_set_level(LED1, 1);
        vTaskDelay(pdMS_TO_TICKS(500));
        gpio_set_level(LED1, 0);
        vTaskDelay(pdMS_TO_TICKS(500));
    }
}

// Task 2: Alternate LED2 and LED3
// void led_alternate_task(void *pvParameter)
// {
//     while (1)
//     {
//         gpio_set_level(LED2, 1);
//         gpio_set_level(LED3, 0);
//         vTaskDelay(pdMS_TO_TICKS(500));

//         gpio_set_level(LED2, 0);
//         gpio_set_level(LED3, 1);
//         vTaskDelay(pdMS_TO_TICKS(500));
//     }
// }

void app_main(void)
{
    configure_leds();

    // Create two FreeRTOS tasks
    xTaskCreate(led1_task, "LED1_Task", 2048, NULL, 5, NULL);
    // xTaskCreate(led_alternate_task, "LED_Alt_Task", 2048, NULL, 5, NULL);
}
